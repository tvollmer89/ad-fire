!function(e,t,n,i){"use strict";function r(t){t=t||"",e.error("Not implemented: "+t)}function o(t,n){t||(n=n?": "+n:"",e.error("Assertion failed"+n))}function s(e,n){var i,r,o=t.console?t.console[e]:null;if(o)if(o.apply)o.apply(t.console,n);else{for(r="",i=0;i<n.length;i++)r+=n[i];o(r)}}function a(e){return!(!e.tree||e.statusNodeType===i)}function l(t){var n,i,r,o=e.map(e.trim(t).split("."),function(e){return parseInt(e,10)}),s=e.map(Array.prototype.slice.call(arguments,1),function(e){return parseInt(e,10)});for(n=0;n<s.length;n++)if(i=o[n]||0,r=s[n]||0,i!==r)return i>r;return!0}function d(e,t,n,i,r){var o=function(){var n=t[e],o=i[e],s=t.ext[r],a=function(){return n.apply(t,arguments)};return function(){var e=t._local,n=t._super;try{return t._local=s,t._super=a,o.apply(t,arguments)}finally{t._local=e,t._super=n}}}();return o}function c(t,n,i,r){for(var o in i)"function"==typeof i[o]?"function"==typeof t[o]?t[o]=d(o,t,n,i,r):"_"===o.charAt(0)?t.ext[r][o]=d(o,t,n,i,r):e.error("Could not override tree."+o+". Use prefix '_' to create tree."+r+"._"+o):"options"!==o&&(t.ext[r][o]=i[o])}function h(t,n){return t===i?e.Deferred(function(){this.resolve()}).promise():e.Deferred(function(){this.resolveWith(t,n)}).promise()}function u(t,n){return t===i?e.Deferred(function(){this.reject()}).promise():e.Deferred(function(){this.rejectWith(t,n)}).promise()}function f(e,t){return function(){e.resolveWith(t)}}function p(t){var n=e.extend({},t.data()),i=n.json;return delete n.fancytree,i&&(delete n.json,n=e.extend(n,i)),n}function g(e){return e=e.toLowerCase(),function(t){return t.title.toLowerCase().indexOf(e)>=0}}function v(t,n){var i,r,s,a;for(this.parent=t,this.tree=t.tree,this.ul=null,this.li=null,this.statusNodeType=null,this._isLoading=!1,this._error=null,this.data={},i=0,r=_.length;r>i;i++)s=_[i],this[s]=n[s];n.data&&e.extend(this.data,n.data);for(s in n)S[s]||e.isFunction(n[s])||C[s]||(this.data[s]=n[s]);null==this.key?this.tree.options.defaultKey?(this.key=this.tree.options.defaultKey(this),o(this.key,"defaultKey() must return a unique key")):this.key="_"+m._nextNodeKey++:this.key=""+this.key,n.active&&(o(null===this.tree.activeNode,"only one active node allowed"),this.tree.activeNode=this),n.selected&&(this.tree.lastSelectedNode=this),this.children=null,a=n.children,a&&a.length&&this._setChildren(a),this.tree._callHook("treeRegisterNode",this.tree,!0,this)}function y(t){this.widget=t,this.$div=t.element,this.options=t.options,this.options&&e.isFunction(this.options.lazyload)&&(e.isFunction(this.options.lazyLoad)||(this.options.lazyLoad=function(){m.warn("The 'lazyload' event is deprecated since 2014-02-25. Use 'lazyLoad' (with uppercase L) instead."),t.options.lazyload.apply(this,arguments)})),this.options&&e.isFunction(this.options.loaderror)&&e.error("The 'loaderror' event was renamed since 2014-07-03. Use 'loadError' (with uppercase E) instead."),this.ext={},this.data=p(this.$div),this._id=e.ui.fancytree._nextId++,this._ns=".fancytree-"+this._id,this.activeNode=null,this.focusNode=null,this._hasFocus=null,this.lastSelectedNode=null,this.systemFocusElement=null,this.statusClassPropName="span",this.ariaPropName="li",this.nodeContainerAttrName="li",this.$div.find(">ul.fancytree-container").remove();var n,i={tree:this};this.rootNode=new v(i,{title:"root",key:"root_"+this._id,children:null,expanded:!0}),this.rootNode.parent=null,n=e("<ul>",{class:"ui-fancytree fancytree-container"}).appendTo(this.$div),this.$container=n,this.rootNode.ul=n[0],null==this.options.debugLevel&&(this.options.debugLevel=m.debugLevel),this.$container.attr("tabindex",this.options.tabbable?"0":"-1"),this.options.aria&&this.$container.attr("role","tree").attr("aria-multiselectable",!0)}if(e.ui.fancytree&&e.ui.fancytree.version)return void e.ui.fancytree.warn("Fancytree: ignored duplicate include");var b,m=null,x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},N="active expanded focus folder hideCheckbox lazy selected unselectable".split(" "),k={},_="expanded extraClasses folder hideCheckbox key lazy refKey selected title tooltip unselectable".split(" "),S={},C={active:!0,children:!0,data:!0,focus:!0};for(b=0;b<N.length;b++)k[N[b]]=!0;for(b=0;b<_.length;b++)S[_[b]]=!0;v.prototype={_findDirectChild:function(e){var t,n,i=this.children;if(i)if("string"==typeof e){for(t=0,n=i.length;n>t;t++)if(i[t].key===e)return i[t]}else{if("number"==typeof e)return this.children[e];if(e.parent===this)return e}return null},_setChildren:function(e){o(e&&(!this.children||0===this.children.length),"only init supported"),this.children=[];for(var t=0,n=e.length;n>t;t++)this.children.push(new v(this,e[t]))},addChildren:function(t,n){var i,r,s,a=null,l=[];for(e.isPlainObject(t)&&(t=[t]),this.children||(this.children=[]),i=0,r=t.length;r>i;i++)l.push(new v(this,t[i]));return a=l[0],null==n?this.children=this.children.concat(l):(n=this._findDirectChild(n),s=e.inArray(n,this.children),o(s>=0,"insertBefore must be an existing child"),this.children.splice.apply(this.children,[s,0].concat(l))),(!this.parent||this.parent.ul||this.tr)&&this.render(),3===this.tree.options.selectMode&&this.fixSelection3FromEndNodes(),a},addNode:function(e,t){switch((t===i||"over"===t)&&(t="child"),t){case"after":return this.getParent().addChildren(e,this.getNextSibling());case"before":return this.getParent().addChildren(e,this);case"child":case"over":return this.addChildren(e)}o(!1,"Invalid mode: "+t)},appendSibling:function(e){return this.addNode(e,"after")},applyPatch:function(t){if(null===t)return this.remove(),h(this);var n,i,r,o={children:!0,expanded:!0,parent:!0};for(n in t)r=t[n],o[n]||e.isFunction(r)||(S[n]?this[n]=r:this.data[n]=r);return t.hasOwnProperty("children")&&(this.removeChildren(),t.children&&this._setChildren(t.children)),this.isVisible()&&(this.renderTitle(),this.renderStatus()),i=t.hasOwnProperty("expanded")?this.setExpanded(t.expanded):h(this)},collapseSiblings:function(){return this.tree._callHook("nodeCollapseSiblings",this)},copyTo:function(e,t,n){return e.addNode(this.toDict(!0,n),t)},countChildren:function(e){var t,n,i,r=this.children;if(!r)return 0;if(i=r.length,e!==!1)for(t=0,n=i;n>t;t++)i+=r[t].countChildren();return i},debug:function(){this.tree.options.debugLevel>=2&&(Array.prototype.unshift.call(arguments,this.toString()),s("debug",arguments))},discard:function(){return this.warn("FancytreeNode.discard() is deprecated since 2014-02-16. Use .resetLazy() instead."),this.resetLazy()},findAll:function(t){t=e.isFunction(t)?t:g(t);var n=[];return this.visit(function(e){t(e)&&n.push(e)}),n},findFirst:function(t){t=e.isFunction(t)?t:g(t);var n=null;return this.visit(function(e){return t(e)?(n=e,!1):void 0}),n},_changeSelectStatusAttrs:function(e){var t=!1;switch(e){case!1:t=this.selected||this.partsel,this.selected=!1,this.partsel=!1;break;case!0:t=!this.selected||!this.partsel,this.selected=!0,this.partsel=!0;break;case i:t=this.selected||!this.partsel,this.selected=!1,this.partsel=!0;break;default:o(!1,"invalid state: "+e)}return t&&this.renderStatus(),t},fixSelection3AfterClick:function(){var e=this.isSelected();this.visit(function(t){t._changeSelectStatusAttrs(e)}),this.fixSelection3FromEndNodes()},fixSelection3FromEndNodes:function(){function e(t){var n,r,o,s,a,l,d,c=t.children;if(c&&c.length){for(l=!0,d=!1,n=0,r=c.length;r>n;n++)o=c[n],s=e(o),s!==!1&&(d=!0),s!==!0&&(l=!1);a=!!l||!!d&&i}else a=!!t.selected;return t._changeSelectStatusAttrs(a),a}o(3===this.tree.options.selectMode,"expected selectMode 3"),e(this),this.visitParents(function(e){var t,n,r,o,s=e.children,a=!0,l=!1;for(t=0,n=s.length;n>t;t++)r=s[t],(r.selected||r.partsel)&&(l=!0),r.unselectable||r.selected||(a=!1);o=!!a||!!l&&i,e._changeSelectStatusAttrs(o)})},fromDict:function(t){for(var n in t)S[n]?this[n]=t[n]:"data"===n?e.extend(this.data,t.data):e.isFunction(t[n])||C[n]||(this.data[n]=t[n]);t.children&&(this.removeChildren(),this.addChildren(t.children)),this.renderTitle()},getChildren:function(){return this.hasChildren()===i?i:this.children},getFirstChild:function(){return this.children?this.children[0]:null},getIndex:function(){return e.inArray(this,this.parent.children)},getIndexHier:function(t){t=t||".";var n=[];return e.each(this.getParentList(!1,!0),function(e,t){n.push(t.getIndex()+1)}),n.join(t)},getKeyPath:function(e){var t=[],n=this.tree.options.keyPathSeparator;return this.visitParents(function(e){e.parent&&t.unshift(e.key)},!e),n+t.join(n)},getLastChild:function(){return this.children?this.children[this.children.length-1]:null},getLevel:function(){for(var e=0,t=this.parent;t;)e++,t=t.parent;return e},getNextSibling:function(){if(this.parent){var e,t,n=this.parent.children;for(e=0,t=n.length-1;t>e;e++)if(n[e]===this)return n[e+1]}return null},getParent:function(){return this.parent},getParentList:function(e,t){for(var n=[],i=t?this:this.parent;i;)(e||i.parent)&&n.unshift(i),i=i.parent;return n},getPrevSibling:function(){if(this.parent){var e,t,n=this.parent.children;for(e=1,t=n.length;t>e;e++)if(n[e]===this)return n[e-1]}return null},hasChildren:function(){return this.lazy?null==this.children?i:0!==this.children.length&&(1!==this.children.length||!this.children[0].isStatusNode()||i):!!this.children},hasFocus:function(){return this.tree.hasFocus()&&this.tree.focusNode===this},info:function(){this.tree.options.debugLevel>=1&&(Array.prototype.unshift.call(arguments,this.toString()),s("info",arguments))},isActive:function(){return this.tree.activeNode===this},isChildOf:function(e){return this.parent&&this.parent===e},isDescendantOf:function(e){if(!e||e.tree!==this.tree)return!1;for(var t=this.parent;t;){if(t===e)return!0;t=t.parent}return!1},isExpanded:function(){return!!this.expanded},isFirstSibling:function(){var e=this.parent;return!e||e.children[0]===this},isFolder:function(){return!!this.folder},isLastSibling:function(){var e=this.parent;return!e||e.children[e.children.length-1]===this},isLazy:function(){return!!this.lazy},isLoaded:function(){return!this.lazy||this.hasChildren()!==i},isLoading:function(){return!!this._isLoading},isRoot:function(){return this.tree.rootNode===this},isSelected:function(){return!!this.selected},isStatusNode:function(){return!!this.statusNodeType},isUndefined:function(){return this.hasChildren()===i},isVisible:function(){var e,t,n=this.getParentList(!1,!1);for(e=0,t=n.length;t>e;e++)if(!n[e].expanded)return!1;return!0},lazyLoad:function(e){return this.warn("FancytreeNode.lazyLoad() is deprecated since 2014-02-16. Use .load() instead."),this.load(e)},load:function(e){var t,n,i=this;return o(this.isLazy(),"load() requires a lazy node"),o(e||this.isUndefined(),"Pass forceReload=true to re-load a lazy node"),this.isLoaded()&&this.resetLazy(),n=this.tree._triggerNodeEvent("lazyLoad",this),n===!1?h(this):(o("boolean"!=typeof n,"lazyLoad event must return source in data.result"),t=this.tree._callHook("nodeLoadChildren",this,n),this.expanded&&t.always(function(){i.render()}),t)},makeVisible:function(t){var n,i=this,r=[],o=new e.Deferred,s=this.getParentList(!1,!1),a=s.length,l=!(t&&t.noAnimation===!0),d=!(t&&t.scrollIntoView===!1);for(n=a-1;n>=0;n--)r.push(s[n].setExpanded(!0,t));return e.when.apply(e,r).done(function(){d?i.scrollIntoView(l).done(function(){o.resolve()}):o.resolve()}),o.promise()},moveTo:function(t,n,r){(n===i||"over"===n)&&(n="child");var s,a=this.parent,l="child"===n?t:t.parent;if(this!==t){if(!this.parent)throw"Cannot move system root";if(l.isDescendantOf(this))throw"Cannot move a node to its own descendant";if(1===this.parent.children.length){if(this.parent===l)return;this.parent.children=this.parent.lazy?[]:null,this.parent.expanded=!1}else s=e.inArray(this,this.parent.children),o(s>=0),this.parent.children.splice(s,1);if(this.parent=l,l.hasChildren())switch(n){case"child":l.children.push(this);break;case"before":s=e.inArray(t,l.children),o(s>=0),l.children.splice(s,0,this);break;case"after":s=e.inArray(t,l.children),o(s>=0),l.children.splice(s+1,0,this);break;default:throw"Invalid mode "+n}else l.children=[this];r&&t.visit(r,!0),this.tree!==t.tree&&(this.warn("Cross-tree moveTo is experimantal!"),this.visit(function(e){e.tree=t.tree},!0)),a.isDescendantOf(l)||a.render(),l.isDescendantOf(a)||l===a||l.render()}},navigate:function(t,n){function i(i){if(i){try{i.makeVisible()}catch(e){}return e(i.span).is(":visible")?n===!1?i.setFocus():i.setActive():(i.debug("Navigate: skipping hidden node"),void i.navigate(t,n))}}var r,o,s=!0,a=e.ui.keyCode,l=null;switch(t){case a.BACKSPACE:this.parent&&this.parent.parent&&i(this.parent);break;case a.LEFT:this.expanded?(this.setExpanded(!1),i(this)):this.parent&&this.parent.parent&&i(this.parent);break;case a.RIGHT:this.expanded||!this.children&&!this.lazy?this.children&&this.children.length&&i(this.children[0]):(this.setExpanded(),i(this));break;case a.UP:for(l=this.getPrevSibling();l&&l.expanded&&l.children&&l.children.length;)l=l.children[l.children.length-1];!l&&this.parent&&this.parent.parent&&(l=this.parent),i(l);break;case a.DOWN:if(this.expanded&&this.children&&this.children.length)l=this.children[0];else for(o=this.getParentList(!1,!0),r=o.length-1;r>=0&&!(l=o[r].getNextSibling());r--);i(l);break;default:s=!1}},remove:function(){return this.parent.removeChild(this)},removeChild:function(e){return this.tree._callHook("nodeRemoveChild",this,e)},removeChildren:function(){return this.tree._callHook("nodeRemoveChildren",this)},render:function(e,t){return this.tree._callHook("nodeRender",this,e,t)},renderTitle:function(){return this.tree._callHook("nodeRenderTitle",this)},renderStatus:function(){return this.tree._callHook("nodeRenderStatus",this)},resetLazy:function(){this.removeChildren(),this.expanded=!1,this.lazy=!0,this.children=i,this.renderStatus()},scheduleAction:function(e,t){this.tree.timer&&clearTimeout(this.tree.timer),this.tree.timer=null;var n=this;switch(e){case"cancel":break;case"expand":this.tree.timer=setTimeout(function(){n.tree.debug("setTimeout: trigger expand"),n.setExpanded(!0)},t);break;case"activate":this.tree.timer=setTimeout(function(){n.tree.debug("setTimeout: trigger activate"),n.setActive(!0)},t);break;default:throw"Invalid mode "+e}},scrollIntoView:function(r,s){s!==i&&a(s)&&(this.warn("scrollIntoView() with 'topNode' option is deprecated since 2014-05-08. Use 'options.topNode' instead."),s={topNode:s});var l,d,c,h,u=e.extend({effects:r===!0?{duration:200,queue:!1}:r,scrollOfs:this.tree.options.scrollOfs,scrollParent:this.tree.options.scrollParent||this.tree.$container,topNode:null},s),f=new e.Deferred,p=this,g=e(this.span).height(),v=e(u.scrollParent),y=u.scrollOfs.top||0,b=u.scrollOfs.bottom||0,m=v.height(),x=v.scrollTop(),N=v,k=v[0]===t,_=u.topNode||null,S=null;return o(e(this.span).is(":visible"),"scrollIntoView node is invisible"),k?(d=e(this.span).offset().top,l=_?e(_.span).offset().top:0,N=e("html,body")):(o(v[0]!==n&&v[0]!==n.body,"scrollParent should be an simple element or `window`, not document or body."),h=v.offset().top,d=e(this.span).offset().top-h+x,l=_?e(_.span).offset().top-h+x:0,c=Math.max(0,v.innerHeight()-v[0].clientHeight),m-=c),x+y>d?S=d-y:d+g>x+m-b&&(S=d+g-m+b,_&&(o(e(_.span).is(":visible")),S>l&&(S=l-y))),null!==S?u.effects?(u.effects.complete=function(){f.resolveWith(p)},N.stop(!0).animate({scrollTop:S},u.effects)):(N[0].scrollTop=S,f.resolveWith(this)):f.resolveWith(this),f.promise()},setActive:function(e,t){return this.tree._callHook("nodeSetActive",this,e,t)},setExpanded:function(e,t){return this.tree._callHook("nodeSetExpanded",this,e,t)},setFocus:function(e){return this.tree._callHook("nodeSetFocus",this,e)},setSelected:function(e){return this.tree._callHook("nodeSetSelected",this,e)},setStatus:function(e,t,n){return this.tree._callHook("nodeSetStatus",this,e,t,n)},setTitle:function(e){this.title=e,this.renderTitle()},sortChildren:function(e,t){var n,i,r=this.children;if(r){if(e=e||function(e,t){var n=e.title.toLowerCase(),i=t.title.toLowerCase();return n===i?0:n>i?1:-1},r.sort(e),t)for(n=0,i=r.length;i>n;n++)r[n].children&&r[n].sortChildren(e,"$norender$");"$norender$"!==t&&this.render()}},toDict:function(t,n){var i,r,o,s={},a=this;if(e.each(_,function(e,t){(a[t]||a[t]===!1)&&(s[t]=a[t])}),e.isEmptyObject(this.data)||(s.data=e.extend({},this.data),e.isEmptyObject(s.data)&&delete s.data),n&&n(s),t&&this.hasChildren())for(s.children=[],i=0,r=this.children.length;r>i;i++)o=this.children[i],o.isStatusNode()||s.children.push(o.toDict(!0,n));return s},toggleExpanded:function(){return this.tree._callHook("nodeToggleExpanded",this)},toggleSelected:function(){return this.tree._callHook("nodeToggleSelected",this)},toString:function(){return"<FancytreeNode(#"+this.key+", '"+this.title+"')>"},visit:function(e,t){var n,i,r=!0,o=this.children;if(t===!0&&(r=e(this),r===!1||"skip"===r))return r;if(o)for(n=0,i=o.length;i>n&&(r=o[n].visit(e,!0),r!==!1);n++);return r},visitParents:function(e,t){if(t&&e(this)===!1)return!1;for(var n=this.parent;n;){if(e(n)===!1)return!1;n=n.parent}return!0},warn:function(){Array.prototype.unshift.call(arguments,this.toString()),s("warn",arguments)}},y.prototype={_makeHookContext:function(t,n,r){var o,s;return t.node!==i?(n&&t.originalEvent!==n&&e.error("invalid args"),o=t):t.tree?(s=t.tree,o={node:t,tree:s,widget:s.widget,options:s.widget.options,originalEvent:n}):t.widget?o={node:null,tree:t,widget:t.widget,options:t.widget.options,originalEvent:n}:e.error("invalid args"),r&&e.extend(o,r),o},_callHook:function(t,n){var i=this._makeHookContext(n),r=this[t],o=Array.prototype.slice.call(arguments,2);return e.isFunction(r)||e.error("_callHook('"+t+"') is not a function"),o.unshift(i),r.apply(this,o)},_requireExtension:function(t,n,i,r){i=!!i;var s=this._local.name,a=this.options.extensions,l=e.inArray(t,a)<e.inArray(s,a),d=n&&null==this.ext[t],c=!d&&null!=i&&i!==l;return o(s&&s!==t),!d&&!c||(r||(d||n?(r="'"+s+"' extension requires '"+t+"'",c&&(r+=" to be registered "+(i?"before":"after")+" itself")):r="If used together, `"+t+"` must be registered "+(i?"before":"after")+" `"+s+"`"),e.error(r),!1)},activateKey:function(e){var t=this.getNodeByKey(e);return t?t.setActive():this.activeNode&&this.activeNode.setActive(!1),t},applyPatch:function(t){var n,i,r,s,a,l,d=t.length,c=[];for(i=0;d>i;i++)r=t[i],o(2===r.length,"patchList must be an array of length-2-arrays"),s=r[0],a=r[1],l=null===s?this.rootNode:this.getNodeByKey(s),l?(n=new e.Deferred,c.push(n),l.applyPatch(a).always(f(n,l))):this.warn("could not find node with key '"+s+"'");return e.when.apply(e,c).promise()},count:function(){return this.rootNode.countChildren()},debug:function(){this.options.debugLevel>=2&&(Array.prototype.unshift.call(arguments,this.toString()),s("debug",arguments))},generateFormElements:function(t,n){var i,r=t!==!1?"ft_"+this._id+"[]":t,o=n!==!1?"ft_"+this._id+"_active":n,s="fancytree_result_"+this._id,a=e("#"+s);a.length?a.empty():a=e("<div>",{id:s}).hide().insertAfter(this.$container),r&&(i=this.getSelectedNodes(3===this.options.selectMode),e.each(i,function(t,n){a.append(e("<input>",{type:"checkbox",name:r,value:n.key,checked:!0}))})),o&&this.activeNode&&a.append(e("<input>",{type:"radio",name:o,value:this.activeNode.key,checked:!0}))},getActiveNode:function(){return this.activeNode},getFirstChild:function(){return this.rootNode.getFirstChild()},getFocusNode:function(){return this.focusNode},getNodeByKey:function(e,t){var i,r;return!t&&(i=n.getElementById(this.options.idPrefix+e))?i.ftnode?i.ftnode:null:(t=t||this.rootNode,r=null,t.visit(function(t){return t.key===e?(r=t,!1):void 0},!0),r)},getRootNode:function(){return this.rootNode},getSelectedNodes:function(e){var t=[];return this.rootNode.visit(function(n){return n.selected&&(t.push(n),e===!0)?"skip":void 0}),t},hasFocus:function(){return!!this._hasFocus},info:function(){this.options.debugLevel>=1&&(Array.prototype.unshift.call(arguments,this.toString()),s("info",arguments))},loadKeyPath:function(t,n,r){function o(e,t,i){n.call(y,t,"loading"),t.load().done(function(){y.loadKeyPath.call(y,h[e],n,t).always(f(i,y))}).fail(function(){y.warn("loadKeyPath: error loading: "+e+" (parent: "+g+")"),n.call(y,t,"error"),i.reject()})}var s,a,l,d,c,h,u,p,g=r||this.rootNode,v=this.options.keyPathSeparator,y=this;for(e.isArray(t)||(t=[t]),h={},l=0;l<t.length;l++)for(d=t[l],d.charAt(0)===v&&(d=d.substr(1)),p=d.split(v);p.length;){if(c=p.shift(),u=g._findDirectChild(c),!u){this.warn("loadKeyPath: key not found: "+c+" (parent: "+g+")"),n.call(this,c,"error");break}if(0===p.length){n.call(this,u,"ok");break}if(u.lazy&&u.hasChildren()===i){n.call(this,u,"loaded"),h[c]?h[c].push(p.join(v)):h[c]=[p.join(v)];break}n.call(this,u,"loaded"),g=u}s=[];for(c in h)u=g._findDirectChild(c),a=new e.Deferred,s.push(a),o(c,u,a);return e.when.apply(e,s).promise()},reactivate:function(e){var t=this.activeNode;t&&(this.activeNode=null,t.setActive(),e&&t.setFocus())},reload:function(e){return this._callHook("treeClear",this),this._callHook("treeLoad",this,e)},render:function(e,t){return this.rootNode.render(e,t)},setFocus:function(e){return this._callHook("treeSetFocus",this,e)},toDict:function(e,t){var n=this.rootNode.toDict(!0,t);return e?n:n.children},toString:function(){return"<Fancytree(#"+this._id+")>"},_triggerNodeEvent:function(e,t,n,r){var o=this._makeHookContext(t,n,r),s=this.widget._trigger(e,n,o);return s!==!1&&o.result!==i?o.result:s},_triggerTreeEvent:function(e,t){var n=this._makeHookContext(this,t),r=this.widget._trigger(e,t,n);return r!==!1&&n.result!==i?n.result:r},visit:function(e){return this.rootNode.visit(e,!1)},warn:function(){Array.prototype.unshift.call(arguments,this.toString()),s("warn",arguments)}},e.extend(y.prototype,{nodeClick:function(e){var t,n,i=e.originalEvent,r=e.targetType,o=e.node;if("expander"===r)this._callHook("nodeToggleExpanded",e);else if("checkbox"===r)this._callHook("nodeToggleSelected",e),this._callHook("nodeSetFocus",e,!0);else{if(n=!1,t=!0,o.folder)switch(e.options.clickFolderMode){case 2:n=!0,t=!1;break;case 3:t=!0,n=!0}t&&(this.nodeSetFocus(e),this._callHook("nodeSetActive",e,!0)),n&&this._callHook("nodeToggleExpanded",e)}"a"===i.target.localName&&"fancytree-title"===i.target.className&&i.preventDefault()},nodeCollapseSiblings:function(e,t){var n,i,r,o=e.node;if(o.parent)for(n=o.parent.children,i=0,r=n.length;r>i;i++)n[i]!==o&&n[i].expanded&&this._callHook("nodeSetExpanded",n[i],!1,t)},nodeDblclick:function(e){"title"===e.targetType&&4===e.options.clickFolderMode&&this._callHook("nodeToggleExpanded",e),"title"===e.targetType&&e.originalEvent.preventDefault()},nodeKeydown:function(t){var n,i=t.originalEvent,r=t.node,o=t.tree,s=t.options,a=!0,l=!(i.ctrlKey||!s.autoActivate),d=e.ui.keyCode;switch(r||(this.rootNode.getFirstChild().setFocus(),r=t.node=this.focusNode,r.debug("Keydown force focus on first node")),i.which){case d.NUMPAD_ADD:case 187:o.nodeSetExpanded(t,!0);break;case d.NUMPAD_SUBTRACT:case 189:o.nodeSetExpanded(t,!1);break;case d.SPACE:s.checkbox?o.nodeToggleSelected(t):o.nodeSetActive(t,!0);break;case d.ENTER:o.nodeSetActive(t,!0);break;case d.BACKSPACE:case d.LEFT:case d.RIGHT:case d.UP:case d.DOWN:n=r.navigate(i.which,l);break;default:a=!1}a&&i.preventDefault()},nodeLoadChildren:function(t,n){var i,r,s,a=t.tree,l=t.node;return e.isFunction(n)&&(n=n()),n.url&&(i=e.extend({},t.options.ajax,n),i.debugDelay?(r=i.debugDelay,e.isArray(r)&&(r=r[0]+Math.random()*(r[1]-r[0])),l.debug("nodeLoadChildren waiting debug delay "+Math.round(r)+"ms"),i.debugDelay=!1,s=e.Deferred(function(t){setTimeout(function(){e.ajax(i).done(function(){t.resolveWith(this,arguments)}).fail(function(){t.rejectWith(this,arguments)})},r)})):s=e.ajax(i),n=new e.Deferred,s.done(function(i){var r,o;if("string"==typeof i&&e.error("Ajax request returned a string (did you get the JSON dataType wrong?)."),t.options.postProcess){if(o=a._triggerNodeEvent("postProcess",t,t.originalEvent,{response:i,error:null,dataType:this.dataType}),o.error)return r=e.isPlainObject(o.error)?o.error:{message:o.error},r=a._makeHookContext(l,null,r),void n.rejectWith(this,[r]);i=e.isArray(o)?o:i}else i&&i.hasOwnProperty("d")&&t.options.enableAspx&&(i="string"==typeof i.d?e.parseJSON(i.d):i.d);n.resolveWith(this,[i])}).fail(function(e,t,i){var r=a._makeHookContext(l,null,{error:e,args:Array.prototype.slice.call(arguments),message:i,details:e.status+": "+i});n.rejectWith(this,[r])})),e.isFunction(n.promise)&&(o(!l.isLoading()),a.nodeSetStatus(t,"loading"),n.done(function(){a.nodeSetStatus(t,"ok")}).fail(function(e){var n;n=e.node&&e.error&&e.message?e:a._makeHookContext(l,null,{error:e,args:Array.prototype.slice.call(arguments),message:e?e.message||e.toString():""}),a._triggerNodeEvent("loadError",n,null)!==!1&&a.nodeSetStatus(t,"error",n.message,n.details)})),e.when(n).done(function(t){var n;e.isPlainObject(t)&&(o(e.isArray(t.children),"source must contain (or be) an array of children"),o(l.isRoot(),"source may only be an object for root nodes"),n=t,t=t.children,delete n.children,e.extend(a.data,n)),o(e.isArray(t),"expected array of children"),l._setChildren(t),a._triggerNodeEvent("loadChildren",l)})},nodeLoadKeyPath:function(){},nodeRemoveChild:function(t,n){var i,r=t.node,s=t.options,a=e.extend({},t,{node:n}),l=r.children;return 1===l.length?(o(n===l[0]),this.nodeRemoveChildren(t)):(this.activeNode&&(n===this.activeNode||this.activeNode.isDescendantOf(n))&&this.activeNode.setActive(!1),this.focusNode&&(n===this.focusNode||this.focusNode.isDescendantOf(n))&&(this.focusNode=null),this.nodeRemoveMarkup(a),this.nodeRemoveChildren(a),i=e.inArray(n,l),o(i>=0),n.visit(function(e){e.parent=null},!0),this._callHook("treeRegisterNode",this,!1,n),s.removeNode&&s.removeNode.call(t.tree,{type:"removeNode"},a),void l.splice(i,1))},nodeRemoveChildMarkup:function(t){var n=t.node;n.ul&&(n.isRoot()?e(n.ul).empty():(e(n.ul).remove(),n.ul=null),n.visit(function(e){e.li=e.ul=null}))},nodeRemoveChildren:function(t){var n,i=t.tree,r=t.node,o=r.children,s=t.options;o&&(this.activeNode&&this.activeNode.isDescendantOf(r)&&this.activeNode.setActive(!1),this.focusNode&&this.focusNode.isDescendantOf(r)&&(this.focusNode=null),this.nodeRemoveChildMarkup(t),n=e.extend({},t),r.visit(function(e){e.parent=null,i._callHook("treeRegisterNode",i,!1,e),s.removeNode&&(n.node=e,s.removeNode.call(t.tree,{type:"removeNode"},n))}),r.children=r.lazy?[]:null,this.nodeRenderStatus(t))},nodeRemoveMarkup:function(t){var n=t.node;n.li&&(e(n.li).remove(),n.li=null),this.nodeRemoveChildMarkup(t)},nodeRender:function(t,i,r,s,a){var l,d,c,h,u,f,p,g=t.node,v=t.tree,y=t.options,b=y.aria,m=!1,x=g.parent,N=!x,k=g.children;if(N||x.ul){if(o(N||x.ul,"parent UL must exist"),N||(g.li&&(i||g.li.parentNode!==g.parent.ul)&&(g.li.parentNode!==g.parent.ul&&this.warn("unlink "+g+" (must be child of "+g.parent+")"),this.nodeRemoveMarkup(t)),g.li?this.nodeRenderStatus(t):(m=!0,g.li=n.createElement("li"),g.li.ftnode=g,g.key&&y.generateIds&&(g.li.id=y.idPrefix+g.key),g.span=n.createElement("span"),g.span.className="fancytree-node",b&&e(g.span).attr("aria-labelledby","ftal_"+g.key),g.li.appendChild(g.span),this.nodeRenderTitle(t),y.createNode&&y.createNode.call(v,{type:"createNode"},t)),y.renderNode&&y.renderNode.call(v,{type:"renderNode"},t)),k){if(N||g.expanded||r===!0){for(g.ul||(g.ul=n.createElement("ul"),(s===!0&&!a||!g.expanded)&&(g.ul.style.display="none"),b&&e(g.ul).attr("role","group"),g.li?g.li.appendChild(g.ul):g.tree.$div.append(g.ul)),h=0,u=k.length;u>h;h++)p=e.extend({},t,{node:k[h]}),this.nodeRender(p,i,r,!1,!0);for(l=g.ul.firstChild;l;)c=l.ftnode,c&&c.parent!==g?(g.debug("_fixParent: remove missing "+c,l),f=l.nextSibling,l.parentNode.removeChild(l),l=f):l=l.nextSibling;for(l=g.ul.firstChild,h=0,u=k.length-1;u>h;h++)d=k[h],c=l.ftnode,d!==c?g.ul.insertBefore(d.li,c.li):l=l.nextSibling}}else g.ul&&(this.warn("remove child markup for "+g),this.nodeRemoveChildMarkup(t));N||m&&x.ul.appendChild(g.li)}},nodeRenderTitle:function(e,t){var n,r,o,s,a,l,d=e.node,c=e.tree,h=e.options,u=h.aria,f=d.getLevel(),p=[],g=d.data.icon;t!==i&&(d.title=t),d.span&&(f<h.minExpandLevel?f>1&&p.push(u?"<span role='button' class='fancytree-expander'></span>":"<span class='fancytree-expander'></span>"):p.push(u?"<span role='button' class='fancytree-expander'></span>":"<span class='fancytree-expander'></span>"),h.checkbox&&d.hideCheckbox!==!0&&!d.isStatusNode()&&p.push(u?"<span role='checkbox' class='fancytree-checkbox'></span>":"<span class='fancytree-checkbox'></span>"),s=u?" role='img'":"",g&&"string"==typeof g?(r="/"===g.charAt(0)?g:(h.imagePath||"")+g,p.push("<img src='"+r+"' class='fancytree-icon' alt='' />")):d.data.iconclass?p.push("<span "+s+" class='fancytree-custom-icon "+d.data.iconclass+"'></span>"):(g===!0||g!==!1&&h.icons!==!1)&&p.push("<span "+s+" class='fancytree-icon'></span>"),o="",h.renderTitle&&(o=h.renderTitle.call(c,{type:"renderTitle"},e)||""),o||(l=d.tooltip?" title='"+m.escapeHtml(d.tooltip)+"'":"",n=u?" id='ftal_"+d.key+"'":"",s=u?" role='treeitem'":"",a=h.titlesTabbable?" tabindex='0'":"",o="<span "+s+" class='fancytree-title'"+n+l+a+">"+d.title+"</span>"),p.push(o),d.span.innerHTML=p.join(""),this.nodeRenderStatus(e))},nodeRenderStatus:function(t){var n=t.node,i=t.tree,r=t.options,o=n.hasChildren(),s=n.isLastSibling(),a=r.aria,l=e(n.span).find(".fancytree-title"),d=r._classNames,c=[],h=n[i.statusClassPropName];h&&(c.push(d.node),i.activeNode===n&&c.push(d.active),i.focusNode===n?(c.push(d.focused),a&&l.attr("aria-activedescendant",!0)):a&&l.removeAttr("aria-activedescendant"),n.expanded?(c.push(d.expanded),a&&l.attr("aria-expanded",!0)):a&&l.removeAttr("aria-expanded"),n.folder&&c.push(d.folder),o!==!1&&c.push(d.hasChildren),s&&c.push(d.lastsib),n.lazy&&null==n.children&&c.push(d.lazy),n.partsel&&c.push(d.partsel),n._isLoading&&c.push(d.loading),n._error&&c.push(d.error),n.selected?(c.push(d.selected),a&&l.attr("aria-selected",!0)):a&&l.attr("aria-selected",!1),n.extraClasses&&c.push(n.extraClasses),c.push(o===!1?d.combinedExpanderPrefix+"n"+(s?"l":""):d.combinedExpanderPrefix+(n.expanded?"e":"c")+(n.lazy&&null==n.children?"d":"")+(s?"l":"")),c.push(d.combinedIconPrefix+(n.expanded?"e":"c")+(n.folder?"f":"")),h.className=c.join(" "),n.li&&(n.li.className=s?d.lastsib:""))},nodeSetActive:function(t,n,i){i=i||{};var r,s=t.node,a=t.tree,l=t.options,d=i.noEvents===!0,c=s===a.activeNode;return n=n!==!1,c===n?h(s):n&&!d&&this._triggerNodeEvent("beforeActivate",s,t.originalEvent)===!1?u(s,["rejected"]):void(n?(a.activeNode&&(o(a.activeNode!==s,"node was active (inconsistency)"),r=e.extend({},t,{node:a.activeNode}),a.nodeSetActive(r,!1),o(null===a.activeNode,"deactivate was out of sync?")),l.activeVisible&&s.makeVisible({scrollIntoView:!1}),a.activeNode=s,a.nodeRenderStatus(t),a.nodeSetFocus(t),d||a._triggerNodeEvent("activate",s,t.originalEvent)):(o(a.activeNode===s,"node was not active (inconsistency)"),a.activeNode=null,this.nodeRenderStatus(t),d||t.tree._triggerNodeEvent("deactivate",s,t.originalEvent)))},nodeSetExpanded:function(t,n,r){r=r||{};var o,s,a,l,d,c,f=t.node,p=t.tree,g=t.options,v=r.noAnimation===!0,y=r.noEvents===!0;if(n=n!==!1,f.expanded&&n||!f.expanded&&!n)return h(f);if(n&&!f.lazy&&!f.hasChildren())return h(f);if(!n&&f.getLevel()<g.minExpandLevel)return u(f,["locked"]);if(!y&&this._triggerNodeEvent("beforeExpand",f,t.originalEvent)===!1)return u(f,["rejected"]);if(v||f.isVisible()||(v=r.noAnimation=!0),s=new e.Deferred,n&&!f.expanded&&g.autoCollapse){d=f.getParentList(!1,!0),c=g.autoCollapse;try{for(g.autoCollapse=!1,a=0,l=d.length;l>a;a++)this._callHook("nodeCollapseSiblings",d[a],r)}finally{g.autoCollapse=c}}return s.done(function(){n&&g.autoScroll&&!v?f.getLastChild().scrollIntoView(!0,{topNode:f}).always(function(){y||t.tree._triggerNodeEvent(n?"expand":"collapse",t)}):y||t.tree._triggerNodeEvent(n?"expand":"collapse",t)}),o=function(i){var r,o,s,a;if(f.expanded=n,p._callHook("nodeRender",t,!1,!1,!0),f.ul)if(s="none"!==f.ul.style.display,a=!!f.expanded,s===a)f.warn("nodeSetExpanded: UL.style.display already set");else{if(g.fx&&!v)return r=g.fx.duration||200,
o=g.fx.easing,void e(f.ul).animate(g.fx,r,o,function(){i()});f.ul.style.display=f.expanded||!parent?"":"none"}i()},n&&f.lazy&&f.hasChildren()===i?f.load().done(function(){s.notifyWith&&s.notifyWith(f,["loaded"]),o(function(){s.resolveWith(f)})}).fail(function(e){o(function(){s.rejectWith(f,["load failed ("+e+")"])})}):o(function(){s.resolveWith(f)}),s.promise()},nodeSetFocus:function(t,n){var i,r=t.tree,o=t.node;if(n=n!==!1,r.focusNode){if(r.focusNode===o&&n)return;i=e.extend({},t,{node:r.focusNode}),r.focusNode=null,this._triggerNodeEvent("blur",i),this._callHook("nodeRenderStatus",i)}n&&(this.hasFocus()||(o.debug("nodeSetFocus: forcing container focus"),this._callHook("treeSetFocus",t,!0,!0)),o.makeVisible({scrollIntoView:!1}),r.focusNode=o,this._triggerNodeEvent("focus",t),t.options.autoScroll&&o.scrollIntoView(),this._callHook("nodeRenderStatus",t))},nodeSetSelected:function(e,t){var n=e.node,i=e.tree,r=e.options;if(t=t!==!1,n.debug("nodeSetSelected("+t+")",e),!n.unselectable){if(n.selected&&t||!n.selected&&!t)return!!n.selected;if(this._triggerNodeEvent("beforeSelect",n,e.originalEvent)===!1)return!!n.selected;t&&1===r.selectMode?i.lastSelectedNode&&i.lastSelectedNode.setSelected(!1):3===r.selectMode&&(n.selected=t,n.fixSelection3AfterClick()),n.selected=t,this.nodeRenderStatus(e),i.lastSelectedNode=t?n:null,i._triggerNodeEvent("select",e)}},nodeSetStatus:function(t,n,i,r){function o(){var e=a.children?a.children[0]:null;if(e&&e.isStatusNode()){try{a.ul&&(a.ul.removeChild(e.li),e.li=null)}catch(e){}1===a.children.length?a.children=[]:a.children.shift()}}function s(t,n){var i=a.children?a.children[0]:null;return i&&i.isStatusNode()?(e.extend(i,t),l._callHook("nodeRender",i)):(t.key="_statusNode",a._setChildren([t]),a.children[0].statusNodeType=n,l.render()),a.children[0]}var a=t.node,l=t.tree;switch(n){case"ok":o(),a._isLoading=!1,a._error=null,a.renderStatus();break;case"loading":a.parent||s({title:l.options.strings.loading+(i?" ("+i+") ":""),tooltip:r,extraClasses:"fancytree-statusnode-wait"},n),a._isLoading=!0,a._error=null,a.renderStatus();break;case"error":s({title:l.options.strings.loadError+(i?" ("+i+") ":""),tooltip:r,extraClasses:"fancytree-statusnode-error"},n),a._isLoading=!1,a._error={message:i,details:r},a.renderStatus();break;default:e.error("invalid node status "+n)}},nodeToggleExpanded:function(e){return this.nodeSetExpanded(e,!e.node.expanded)},nodeToggleSelected:function(e){return this.nodeSetSelected(e,!e.node.selected)},treeClear:function(e){var t=e.tree;t.activeNode=null,t.focusNode=null,t.$div.find(">ul.fancytree-container").empty(),t.rootNode.children=null},treeCreate:function(){},treeDestroy:function(){},treeInit:function(e){this.treeLoad(e)},treeLoad:function(t,n){var i,o,s,a=t.tree,l=t.widget.element,d=e.extend({},t,{node:this.rootNode});if(a.rootNode.children&&this.treeClear(t),n=n||this.options.source)"string"==typeof n&&r();else switch(i=l.data("type")||"html"){case"html":o=l.find(">ul:first"),o.addClass("ui-fancytree-source ui-helper-hidden"),n=e.ui.fancytree.parseHtml(o),this.data=e.extend(this.data,p(o));break;case"json":n=e.parseJSON(l.text()),n.children&&(n.title&&(a.title=n.title),n=n.children);break;default:e.error("Invalid data-type: "+i)}return s=this.nodeLoadChildren(d,n).done(function(){a.render(),3===t.options.selectMode&&a.rootNode.fixSelection3FromEndNodes(),a._triggerTreeEvent("init",!0)}).fail(function(){a.render(),a._triggerTreeEvent("init",!1)})},treeRegisterNode:function(){},treeSetFocus:function(e,t){t=t!==!1,t!==this.hasFocus()&&(this._hasFocus=t,this.$container.toggleClass("fancytree-treefocus",t),this._triggerTreeEvent(t?"focusTree":"blurTree"))}}),e.widget("ui.fancytree",{options:{activeVisible:!0,ajax:{type:"GET",cache:!1,dataType:"json"},aria:!1,autoActivate:!0,autoCollapse:!1,autoScroll:!1,checkbox:!1,clickFolderMode:4,debugLevel:null,disabled:!1,enableAspx:!0,extensions:[],fx:{height:"toggle",duration:200},generateIds:!1,icons:!0,idPrefix:"ft_",keyboard:!0,keyPathSeparator:"/",minExpandLevel:1,scrollOfs:{top:0,bottom:0},scrollParent:null,selectMode:2,strings:{loading:"Loading&#8230;",loadError:"Load error!"},tabbable:!0,titlesTabbable:!1,_classNames:{node:"fancytree-node",folder:"fancytree-folder",combinedExpanderPrefix:"fancytree-exp-",combinedIconPrefix:"fancytree-ico-",hasChildren:"fancytree-has-children",active:"fancytree-active",selected:"fancytree-selected",expanded:"fancytree-expanded",lazy:"fancytree-lazy",focused:"fancytree-focused",partsel:"fancytree-partsel",lastsib:"fancytree-lastsib",loading:"fancytree-loading",error:"fancytree-error"},lazyLoad:null,postProcess:null},_create:function(){this.tree=new y(this),this.$source=this.source||"json"===this.element.data("type")?this.element:this.element.find(">ul:first");var t,n,r,s=this.options.extensions,a=this.tree;for(r=0;r<s.length;r++)n=s[r],t=e.ui.fancytree._extensions[n],t||e.error("Could not apply extension '"+n+"' (it is not registered, did you forget to include it?)"),this.tree.options[n]=e.extend(!0,{},t.options,this.tree.options[n]),o(this.tree.ext[n]===i,"Extension name must not exist as Fancytree.ext attribute: '"+n+"'"),this.tree.ext[n]={},c(this.tree,a,t,n),a=t;this.tree._callHook("treeCreate",this.tree)},_init:function(){this.tree._callHook("treeInit",this.tree),this._bind()},_setOption:function(t,n){var i=!0,r=!1;switch(t){case"aria":case"checkbox":case"icons":case"minExpandLevel":case"tabbable":this.tree._callHook("treeCreate",this.tree),r=!0;break;case"source":i=!1,this.tree._callHook("treeLoad",this.tree,n)}this.tree.debug("set option "+t+"="+n+" <"+typeof n+">"),i&&e.Widget.prototype._setOption.apply(this,arguments),r&&this.tree.render(!0,!1)},destroy:function(){this._unbind(),this.tree._callHook("treeDestroy",this.tree),this.tree.$div.find(">ul.fancytree-container").remove(),this.$source&&this.$source.removeClass("ui-helper-hidden"),e.Widget.prototype.destroy.call(this)},_unbind:function(){var t=this.tree._ns;this.element.unbind(t),this.tree.$container.unbind(t),e(n).unbind(t)},_bind:function(){var e=this,t=this.options,n=this.tree,i=n._ns;this._unbind(),n.$container.on("focusin"+i+" focusout"+i,function(e){var t=m.getNode(e),i="focusin"===e.type;t?n._callHook("nodeSetFocus",t,i):n._callHook("treeSetFocus",n,i)}).on("selectstart"+i,"span.fancytree-title",function(e){e.preventDefault()}).on("keydown"+i,function(e){if(t.disabled||t.keyboard===!1)return!0;var i,r=n.focusNode,o=n._makeHookContext(r||n,e),s=n.phase;try{return n.phase="userEvent",i=r?n._triggerNodeEvent("keydown",r,e):n._triggerTreeEvent("keydown",e),"preventNav"===i?i=!0:i!==!1&&(i=n._callHook("nodeKeydown",o)),i}finally{n.phase=s}}).on("click"+i+" dblclick"+i,function(n){if(t.disabled)return!0;var i,r=m.getEventTarget(n),o=r.node,s=e.tree,a=s.phase;if(!o)return!0;i=s._makeHookContext(o,n);try{switch(s.phase="userEvent",n.type){case"click":return i.targetType=r.type,s._triggerNodeEvent("click",i,n)!==!1&&s._callHook("nodeClick",i);case"dblclick":return i.targetType=r.type,s._triggerNodeEvent("dblclick",i,n)!==!1&&s._callHook("nodeDblclick",i)}}finally{s.phase=a}})},getActiveNode:function(){return this.tree.activeNode},getNodeByKey:function(e){return this.tree.getNodeByKey(e)},getRootNode:function(){return this.tree.rootNode},getTree:function(){return this.tree}}),m=e.ui.fancytree,e.extend(e.ui.fancytree,{version:"2.3.0",buildType:"production",debugLevel:1,_nextId:1,_nextNodeKey:1,_extensions:{},_FancytreeClass:y,_FancytreeNodeClass:v,jquerySupports:{positionMyOfs:l(e.ui.version,1,9)},assert:function(e,t){return o(e,t)},debounce:function(e,t,n,i){var r;return 3===arguments.length&&"boolean"!=typeof n&&(i=n,n=!1),function(){var o=arguments;i=i||this,n&&!r&&t.apply(i,o),clearTimeout(r),r=setTimeout(function(){n||t.apply(i,o),r=null},e)}},debug:function(){e.ui.fancytree.debugLevel>=2&&s("log",arguments)},error:function(){s("error",arguments)},escapeHtml:function(e){return(""+e).replace(/[&<>"'\/]/g,function(e){return x[e]})},unescapeHtml:function(e){var t=n.createElement("div");return t.innerHTML=e,0===t.childNodes.length?"":t.childNodes[0].nodeValue},getEventTargetType:function(e){return this.getEventTarget(e).type},getEventTarget:function(t){var n=t&&t.target?t.target.className:"",r={node:this.getNode(t.target),type:i};return/\bfancytree-title\b/.test(n)?r.type="title":/\bfancytree-expander\b/.test(n)?r.type=r.node.hasChildren()===!1?"prefix":"expander":/\bfancytree-checkbox\b/.test(n)||/\bfancytree-radio\b/.test(n)?r.type="checkbox":/\bfancytree-icon\b/.test(n)?r.type="icon":/\bfancytree-node\b/.test(n)?r.type="title":t&&t.target&&e(t.target).closest(".fancytree-title").length&&(r.type="title"),r},getNode:function(e){if(e instanceof v)return e;for(e.selector!==i?e=e[0]:e.originalEvent!==i&&(e=e.target);e;){if(e.ftnode)return e.ftnode;e=e.parentNode}return null},info:function(){e.ui.fancytree.debugLevel>=1&&s("info",arguments)},parseHtml:function(t){var n,r,o,s,a,l,d,c,h=t.find(">li"),u=[];return h.each(function(){var h,f=e(this),g=f.find(">span:first",this),v=g.length?null:f.find(">a:first"),y={tooltip:null,data:{}};for(g.length?y.title=g.html():v&&v.length?(y.title=v.html(),y.data.href=v.attr("href"),y.data.target=v.attr("target"),y.tooltip=v.attr("title")):(y.title=f.html(),s=y.title.search(/<ul/i),s>=0&&(y.title=y.title.substring(0,s))),y.title=e.trim(y.title),r=0,o=N.length;o>r;r++)y[N[r]]=i;for(d=this.className.split(" "),n=[],r=0,o=d.length;o>r;r++)c=d[r],k[c]?y[c]=!0:n.push(c);if(y.extraClasses=n.join(" "),a=f.attr("title"),a&&(y.tooltip=a),a=f.attr("id"),a&&(y.key=a),h=p(f),h&&!e.isEmptyObject(h)){for(r=0,o=_.length;o>r;r++)a=_[r],l=h[a],null!=l&&(delete h[a],y[a]=l);e.extend(y.data,h)}t=f.find(">ul:first"),y.children=t.length?e.ui.fancytree.parseHtml(t):y.lazy?i:null,u.push(y)}),u},registerExtension:function(t){o(null!=t.name,"extensions must have a `name` property."),o(null!=t.version,"extensions must have a `version` property."),e.ui.fancytree._extensions[t.name]=t},warn:function(){s("warn",arguments)}})}(jQuery,window,document);